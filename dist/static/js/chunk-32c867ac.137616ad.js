(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32c867ac"],{"9b97":function(t,e,a){"use strict";a("f763")},b97d:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",[a("div",{staticStyle:{"margin-bottom":"24px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.openAddteacher(!0,"添加老师",null)}}},[t._v("添加老师")])],1),a("common-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list,headers:t.headers,paging:!0,"total-num":t.total,"page-num":t.page,"size-num":t.limit},on:{"update:pageNum":function(e){t.page=e},"update:page-num":function(e){t.page=e},"update:sizeNum":function(e){t.limit=e},"update:size-num":function(e){t.limit=e},callback:t.getTeacherList},scopedSlots:t._u([{key:"operation",fn:function(e){var o=e.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.openAddteacher(!0,"编辑老师",o)}}},[t._v("编辑")]),a("el-button",{staticClass:"btn-delete",attrs:{type:"text"}},[t._v("删除")])]}}])}),a("add-teacher",{attrs:{show:t.showAddteacher,title:t.title,"teacher-info":t.teacherInfo},on:{"update:show":function(e){t.showAddteacher=e},callback:t.teacherCallback}})],1)},r=[],i=a("b775");function n(t,e){return Object(i["a"])({url:"/api/teacher/list",method:"get",params:t,data:e})}function s(t,e){return Object(i["a"])({url:"/api/teacher/update",method:"post",params:t,data:e})}function c(t,e){return Object(i["a"])({url:"/api/teacher/create",method:"post",params:t,data:e})}var l=a("c466"),h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("common-dialog",{attrs:{visible:t.visible,title:t.title,"submit-loading":t.submitLoading},on:{"update:visible":function(e){t.visible=e},submit:t.postDataForTeacher,open:t.onOpen},scopedSlots:t._u([{key:"content",fn:function(){return[a("div",{staticClass:"myfrom"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"老师姓名"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"10",placeholder:"请输入老师姓名"},model:{value:t.form.teacher_name,callback:function(e){t.$set(t.form,"teacher_name",e)},expression:"form.teacher_name"}})],1),a("el-form-item",{attrs:{label:"性别"}},[a("el-radio-group",{model:{value:t.form.sex,callback:function(e){t.$set(t.form,"sex",e)},expression:"form.sex"}},[a("el-radio",{attrs:{label:"1"}},[t._v("男")]),a("el-radio",{attrs:{label:"2"}},[t._v("女")]),a("el-radio",{attrs:{label:"3"}},[t._v("保密")])],1)],1),t.teacherInfo?t._e():a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"11",placeholder:"请输入联系电话"},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),a("el-form-item",{attrs:{label:"老师生日"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.birthday,callback:function(e){t.$set(t.form,"birthday",e)},expression:"form.birthday"}})],1),a("el-form-item",{attrs:{label:"入职日期"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.entry_at,callback:function(e){t.$set(t.form,"entry_at",e)},expression:"form.entry_at"}})],1),a("el-form-item",{attrs:{label:"联系地址"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"50",placeholder:"请输入联系地址"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1)],1)]},proxy:!0}])})},d=[],u=(a("d81d"),a("b64b"),a("5530")),m={props:{show:{type:Boolean,default:!1},title:{type:String,defalut:""},teacherInfo:{type:Object,default:null}},data:function(){return{form:{campus_id:"",teacher_name:"",sex:"",phone:"",birthday:"",entry_at:"",address:"",Identity:"campus"},submitLoading:!1}},computed:{visible:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}},schoolId:function(){return this.$store.state.school.schoolId},campus_id:function(){return this.$store.state.school.campus_id}},methods:{onOpen:function(){var t=this;this.teacherInfo?(Object.keys(this.form).map((function(e){t.form[e]="birthday"===e||"entry_at"===e?t.teacherInfo[e]?new Date(1*t.teacherInfo[e]):"":t.teacherInfo[e]})),console.log(this.form),this.cityArr=[this.form.province,this.form.city,this.form.area]):Object.keys(this.form).map((function(e){t.form[e]=""}))},postDataForTeacher:function(){this.teacherInfo?this.teacherUpdate():this.teacherCreate()},teacherUpdate:function(){var t=this,e={teacher_id:this.teacherInfo.id};this.submitLoading=!0;var a=Object(u["a"])({},this.form);a.birthday=new Date(a.birthday).getTime(),a.entry_at=new Date(a.entry_at).getTime(),s(e,a).then((function(e){t.submitLoading=!1,t.$message({message:"更新成功",type:"success"}),t.visible=!1,t.$emit("callback")})).catch((function(e){t.submitLoading=!1,t.$message.error(e)}))},teacherCreate:function(){var t=this;this.submitLoading=!0;var e={school_id:this.schoolId},a=Object(u["a"])({},this.form);a.birthday=new Date(a.birthday).getTime(),a.entry_at=new Date(a.entry_at).getTime(),a.campus_id=this.campus_id,a.Identity="teacher",c(e,a).then((function(e){t.submitLoading=!1,t.$message({message:"创建成功",type:"success"}),t.visible=!1,t.$emit("callback")})).catch((function(e){t.submitLoading=!1,t.$message.error(e)}))}}},f=m,p=(a("9b97"),a("2877")),b=Object(p["a"])(f,h,d,!1,null,"20cc27c7",null),g=b.exports,y={components:{addTeacher:g},data:function(){return{loading:!1,list:[],headers:[{prop:"teacher_name",label:"老师名称"},{prop:"phone",label:"联系电话"},{prop:"sex",label:"性别",formatter:function(t,e,a){var o={1:"男",2:"女",3:"保密"};return o[a]}},{prop:"birthday",label:"生日",formatter:function(t,e,a){return Object(l["a"])(a,"YYYY-MM-DD")}},{prop:"address",label:"联系地址"},{prop:"entry_at",label:"入职时间",formatter:function(t,e,a){return Object(l["a"])(a,"YYYY-MM-DD")}}],total:0,page:1,limit:10,showAddteacher:!1,title:"",teacherInfo:{}}},computed:{schoolId:function(){return this.$store.state.school.schoolId},campus_id:function(){return this.$store.state.school.campus_id}},created:function(){this.getTeacherList()},methods:{teacherCallback:function(){this.getTeacherList()},openAddteacher:function(t,e,a){this.showAddteacher=t,this.title=e,this.teacherInfo=a},getTeacherList:function(){var t=this;this.loading=!0,n({school_id:this.schoolId,campus_id:this.campus_id,page:this.page,limit:this.limit}).then((function(e){t.loading=!1,t.list=e.data.item,t.total=e.data.total,console.log("res:",e)})).catch((function(){t.loading=!1}))}}},_=y,v=Object(p["a"])(_,o,r,!1,null,null,null);e["default"]=v.exports},f763:function(t,e,a){}}]);