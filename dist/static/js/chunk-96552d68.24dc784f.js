(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-96552d68"],{"1a78":function(t,e,a){"use strict";a("7092")},"34ce":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",[a("div",{staticStyle:{"margin-bottom":"24px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.openAddStudent(!0,"添加学生",null)}}},[t._v("添加学生")])],1),a("common-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list,headers:t.headers,paging:!0,"total-num":t.total,"page-num":t.page,"size-num":t.limit},on:{"update:pageNum":function(e){t.page=e},"update:page-num":function(e){t.page=e},"update:sizeNum":function(e){t.limit=e},"update:size-num":function(e){t.limit=e},callback:t.getStudentList},scopedSlots:t._u([{key:"operation",fn:function(e){var n=e.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.openAddStudent(!0,"编辑学生",n)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.openAddClassMember(n)}}},[t._v("学员入班")]),a("el-button",{staticClass:"btn-delete",attrs:{type:"text"}},[t._v("删除")])]}}])}),a("add-student",{attrs:{show:t.showAddStudent,title:t.title,"student-info":t.studentInfo},on:{"update:show":function(e){t.showAddStudent=e},callback:t.studentCallback}}),a("add-member",{attrs:{show:t.showAddMember,student_id:t.studentInfo&&t.studentInfo.id,member_type:"1"},on:{"update:show":function(e){t.showAddMember=e}}})],1)},s=[],i=a("b775");function o(t,e){return Object(i["a"])({url:"/api/student/list",method:"get",params:t,data:e})}function r(t,e){return Object(i["a"])({url:"/api/student/update",method:"post",params:t,data:e})}function l(t,e){return Object(i["a"])({url:"/api/student/create",method:"post",params:t,data:e})}var u=a("c466"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("common-dialog",{attrs:{visible:t.visible,title:t.title,"submit-loading":t.submitLoading},on:{"update:visible":function(e){t.visible=e},submit:t.postDataForStudent,open:t.onOpen},scopedSlots:t._u([{key:"content",fn:function(){return[a("div",{staticClass:"myfrom"},[a("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"学生名称"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"10",placeholder:"请输入学生姓名"},model:{value:t.form.student_name,callback:function(e){t.$set(t.form,"student_name",e)},expression:"form.student_name"}})],1),a("el-form-item",{attrs:{label:"学生性别"}},[a("el-radio-group",{model:{value:t.form.sex,callback:function(e){t.$set(t.form,"sex",e)},expression:"form.sex"}},t._l(t.sexObj,(function(e,n){return a("el-radio",{key:n,attrs:{label:n}},[t._v(t._s(e))])})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"avatar-box"},[a("pan-thumb",{attrs:{image:t.form.avatar,width:"90px",height:"90px"},nativeOn:{click:function(e){t.imagecropperShow=!0}}},[a("div",{staticClass:"avatar-upload"},[a("i",{staticClass:"el-icon-picture"}),a("div",[t._v("学生头像")])])])],1),a("image-cropper",{directives:[{name:"show",rawName:"v-show",value:t.imagecropperShow,expression:"imagecropperShow"}],key:t.imagecropperKey,attrs:{width:300,height:300,url:"/api/upload/file",field:"file","lang-type":"en"},on:{close:t.close,"crop-upload-success":t.cropSuccess}})],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"学校名称"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"50",placeholder:"请输入学校名称"},model:{value:t.form.school_name,callback:function(e){t.$set(t.form,"school_name",e)},expression:"form.school_name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"学员生日"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.form.birthday,callback:function(e){t.$set(t.form,"birthday",e)},expression:"form.birthday"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"学校地址"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"50",placeholder:"请输入学校地址"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{maxlength:"100",placeholder:"备注信息"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1)],1)],1)]},proxy:!0}])})},d=[],m=(a("d81d"),a("b64b"),a("5530")),p=a("f121"),f={props:{show:{type:Boolean,default:!1},title:{type:String,defalut:""},studentInfo:{type:Object,default:null}},data:function(){return{sexObj:p["h"],form:{student_name:"",sex:"1",avatar:"",school_name:"",birthday:"",address:"",status:"1",remark:""},submitLoading:!1,imagecropperShow:!1,imagecropperKey:0}},computed:{visible:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},methods:{handleAvatarSuccess:function(){},beforeAvatarUpload:function(){},cropSuccess:function(t){this.imagecropperShow=!1,this.imagecropperKey=this.imagecropperKey+1,this.form.avatar=t},close:function(){this.imagecropperShow=!1},onOpen:function(){var t=this;this.studentInfo?(console.log(this.studentInfo),Object.keys(this.form).map((function(e){t.form[e]=t.studentInfo[e]})),this.form.birthday=this.form.birthday?new Date(this.form.birthday):""):this.form={student_name:"",sex:"1",avatar:"",school_name:"",birthday:"",address:"",status:"1",remark:""}},postDataForStudent:function(){this.studentInfo?this.studentUpdate():this.studentCreate()},studentUpdate:function(){var t=this,e={student_id:this.studentInfo.id};this.submitLoading=!0;var a=Object(m["a"])({},this.form);a.birthday=a.birthday?a.birthday.getTime():"",r(e,a).then((function(e){t.submitLoading=!1,t.$message({message:"更新成功",type:"success"}),t.visible=!1,t.$emit("callback")})).catch((function(){t.submitLoading=!1}))},studentCreate:function(){var t=this;this.submitLoading=!0;var e={school_id:this.school_id,campus_id:this.campus_id},a=Object(m["a"])({},this.form);a.birthday=a.birthday?a.birthday.getTime():"",l(e,a).then((function(e){t.submitLoading=!1,t.$message({message:"创建成功",type:"success"}),t.visible=!1,t.$emit("callback")})).catch((function(){t.submitLoading=!1}))}}},h=f,b=(a("1a78"),a("2877")),g=Object(b["a"])(h,c,d,!1,null,"3dc3ed54",null),_=g.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("common-dialog",{attrs:{visible:t.visible,title:"学员入班","submit-loading":t.submitLoading},on:{"update:visible":function(e){t.visible=e},submit:t.postDataForMember,open:t.onOpen},scopedSlots:t._u([{key:"content",fn:function(){return[a("div",{staticClass:"myfrom"},[a("el-form",{ref:"form",attrs:{model:{},"label-width":"80px"}},[a("el-form-item",{attrs:{label:"班级名称"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.class_id,callback:function(e){t.class_id=e},expression:"class_id"}},t._l(t.classList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.class_name,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"入班时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:t.entry_at,callback:function(e){t.entry_at=e},expression:"entry_at"}})],1)],1)],1)]},proxy:!0}])})},v=[],w=(a("a9e3"),a("fbf3")),S={props:{show:{type:Boolean,default:!1},student_id:{type:Number,default:0},member_type:{type:String,default:""}},data:function(){return{class_id:"",entry_at:"",classList:[],submitLoading:!1}},computed:{visible:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},methods:{onOpen:function(){this.classId="",this.getClassSimpleList()},getClassSimpleList:function(){var t=this;Object(w["g"])({school_id:this.school_id,campus_id:this.campus_id}).then((function(e){t.classList=e.data}))},postDataForMember:function(){var t=this,e={school_id:this.school_id,campus_id:this.campus_id,class_id:this.class_id,student_id:this.student_id,member_type:this.member_type,entry_at:this.entry_at};e.entry_at=e.entry_at?new Date(e.entry_at).getTime():"",this.submitLoading=!0,Object(w["c"])({},e).then((function(e){t.submitLoading=!1,t.visible=!1,t.$message.success("入班成功"),t.$emit("callback")})).catch((function(){t.submitLoading=!1}))}}},k=S,x=(a("3878"),Object(b["a"])(k,y,v,!1,null,"1e7075f4",null)),O=x.exports,j={components:{addStudent:_,addMember:O},data:function(){return{loading:!1,list:[],headers:[{prop:"student_name",label:"学生姓名"},{prop:"sex",label:"性别",formatter:function(t,e,a){return p["h"][a]}},{prop:"birthday",label:"学员生日",formatter:function(t,e,a){return Object(u["a"])(a,"YYYY-MM-DD")}},{prop:"status",label:"学生状态",formatter:function(t,e,a){return p["i"][a]}},{prop:"created_at",label:"创建时间",formatter:function(t,e,a){return Object(u["a"])(a,"YYYY-MM-DD")}}],total:0,page:1,limit:10,showAddStudent:!1,showAddMember:!1,title:"",studentInfo:{}}},created:function(){this.getStudentList()},methods:{studentCallback:function(){this.getStudentList()},openAddStudent:function(t,e,a){this.showAddStudent=t,this.title=e,this.studentInfo=a},openAddClassMember:function(t){this.showAddMember=!0,this.studentInfo=t},getStudentList:function(){var t=this;this.loading=!0,o({school_id:this.school_id,campus_id:this.campus_id,page:this.page,limit:this.limit}).then((function(e){t.loading=!1,t.list=e.data.item,t.total=e.data.total})).catch((function(){t.loading=!1}))}}},L=j,$=Object(b["a"])(L,n,s,!1,null,null,null);e["default"]=$.exports},3878:function(t,e,a){"use strict";a("932c")},7092:function(t,e,a){},"932c":function(t,e,a){},f121:function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"h",(function(){return i})),a.d(e,"i",(function(){return o})),a.d(e,"j",(function(){return r})),a.d(e,"a",(function(){return l})),a.d(e,"c",(function(){return u})),a.d(e,"g",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"b",(function(){return m}));var n={1:"正式班",2:"临时班"},s={1:"未开班",2:"已开班",3:"已毕业"},i={1:"男",2:"女",3:"保密"},o={1:"正常",2:"毕业"},r={1:"正常",2:"停用"},l={1:"正常",2:"停用"},u={1:"在班",2:"离班"},c={1:"班课",2:"学员课"},d={1:"未上课",2:"上课中",3:"已下课"},m={1:"课时卡",2:"储值卡",3:"期限卡"}},fbf3:function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return o})),a.d(e,"g",(function(){return r})),a.d(e,"f",(function(){return l})),a.d(e,"d",(function(){return u})),a.d(e,"c",(function(){return c})),a.d(e,"h",(function(){return d}));var n=a("b775");function s(t,e){return Object(n["a"])({url:"/api/class/list",method:"get",params:t,data:e})}function i(t,e){return Object(n["a"])({url:"/api/class/update",method:"post",params:t,data:e})}function o(t,e){return Object(n["a"])({url:"/api/class/create",method:"post",params:t,data:e})}function r(t,e){return Object(n["a"])({url:"/api/class/simple/list",method:"get",params:t,data:e})}function l(t,e){return Object(n["a"])({url:"/api/class/member/list",method:"get",params:t,data:e})}function u(t,e){return Object(n["a"])({url:"/api/class/info",method:"get",params:t,data:e})}function c(t,e){return Object(n["a"])({url:"/api/class/member/create",method:"post",params:t,data:e})}function d(t,e){return Object(n["a"])({url:"/api/class/member/leave",method:"post",params:t,data:e})}}}]);