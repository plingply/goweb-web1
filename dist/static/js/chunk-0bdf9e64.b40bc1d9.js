(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bdf9e64"],{"1cbf":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",[a("div",{staticStyle:{"margin-bottom":"30px"}},[a("el-button",{attrs:{type:"primary",loading:t.start,disabled:t.start},on:{click:t.getPeotryLastId}},[t._v("同步数据")]),a("el-button",{attrs:{plain:""},on:{click:t.playFunc}},[t._v(t._s(t.play?"暂停":"开始"))]),a("span",{staticClass:"progress"},[t._v(" 成功 "),a("span",[t._v(t._s(t.succ))]),t._v(" 条，失败 "),a("span",[t._v(t._s(t.error))]),t._v(" 条 ")]),t._v(" > ")],1),a("common-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.list,headers:t.headers,paging:!0,"total-num":t.total,"page-num":t.page,"size-num":t.limit},on:{"update:pageNum":function(e){t.page=e},"update:page-num":function(e){t.page=e},"update:sizeNum":function(e){t.limit=e},"update:size-num":function(e){t.limit=e},callback:t.getPeotryList},scopedSlots:t._u([{key:"operation",fn:function(e){var n=e.row;return[a("el-button",{staticClass:"btn-delete",attrs:{type:"text"},on:{click:function(e){return t.link(n.zuowen_id)}}},[t._v("详情")])]}}])})],1)},r=[],i=(a("4160"),a("b64b"),a("159b"),a("96cf"),a("1da1")),o=a("b775"),s=a("4328"),u=a.n(s);function c(t,e){return Object(o["a"])({url:"/api/peotry/sync",method:"post",params:t,data:e})}function l(t,e){return Object(o["a"])({url:"https://api.xhzapp.com/api/v5/AppBook/GetShiWenModel",method:"post",params:t,data:u.a.stringify(e,{allowDots:!0})})}function p(t,e){return Object(o["a"])({url:"/api/peotry/lastid",method:"get",params:t,data:e})}function d(t,e){return Object(o["a"])({url:"/api/peotry/lastid",method:"get",params:t,data:e})}var h=a("c466"),f=a("6821"),g=a.n(f),m={data:function(){return{loading:!1,list:[],headers:[{prop:"title",label:"标题"},{prop:"genre",label:"类型"},{prop:"grade",label:"所属年纪"},{prop:"theme",label:"主题"},{prop:"read_count",label:"阅读次数"},{prop:"updated_at",label:"更新时间",formatter:function(t,e,a){return Object(h["a"])(a,"YYYY-MM-DD")}}],total:0,page:1,limit:10,succ:0,error:0,start:!1,play:!0}},created:function(){this.getPeotryList()},destroyed:function(){clearTimeout(this.timeout)},methods:{link:function(t){window.open("/work/zuowenresult.html?zuowen_id="+t)},playFunc:function(){this.play=!this.play,clearTimeout(this.timeout),this.play&&this.getPeotryLastId()},getPeotryList:function(){var t=this;this.loading=!0,d({page:this.page,limit:this.limit}).then((function(e){t.loading=!1,t.list=e.data.item,t.total=e.data.total})).catch((function(){t.loading=!1}))},getPeotryLastId:function(){var t=this;this.play&&p().then((function(e){e.data=0==e.data?9999:e.data,t.start=!0,t.forEachPeotry(e.data+1)}))},forEachPeotry:function(t){for(var e=this,a=t;a<t+20;a++)this.request({shiId:a});this.getPeotryList(),this.timeout=setTimeout((function(){e.getPeotryLastId()}),3e3)},syncData:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c({},t);case 3:e.succ++,e.succ+e.error>=20&&(e.start=!1),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),e.error++;case 10:case"end":return a.stop()}}),a,null,[[0,7]])})))()},objKeySort:function(t){for(var e=Object.keys(t).sort(),a={},n=0;n<e.length;n++)a[e[n]]=t[e[n]];return a},getSign:function(t){var e=g()(t.date),a=this.objKeySort(t),n="";for(var r in a)n+=a[r];n+="CVrFcVJu564ArjsShh058xSjb";var i=e.substring(0,16)+g()(n)+e.substring(16,32);return i},request:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o,s,u,c,p,d,f;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(u in n=null!=t?t:{},r=Object(h["a"])((new Date).getTime()),n.date=r,console.log(n),i=e.getSign(n),n.ciphertext=i,s=[],n)n.hasOwnProperty(u)&&(o=n[u],s.push(u+"="+o));return a.next=10,l(null,n);case 10:if(c=a.sent,1!==c.code){a.next=18;break}return p=c.data,d=c.data.noteList,f={peotry_id:p.id,align:p.align,appreciate:p.appreciate,author:p.author,author_more:p.authorMore,du_yin:p.duYin,org_text:p.orgText,reason:p.reason,title:p.title,translation:p.translation,video:p.video,years:p.years,note_list:[]},d&&d.forEach((function(t,e){f.note_list[e]={ciyu:t.ciyu,notes:t.notes,peotry_id:p.id}})),a.next=18,e.syncData(f);case 18:case"end":return a.stop()}}),a)})))()}}},y=m,b=(a("8872"),a("2877")),v=Object(b["a"])(y,n,r,!1,null,"d1fa3b7e",null);e["default"]=v.exports},8872:function(t,e,a){"use strict";a("c164")},c164:function(t,e,a){}}]);